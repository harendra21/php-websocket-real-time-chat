<span ng-controller="chatCtrl as $ctrl">
  <div class="h-100" ng-if="isUserLoggedIn" ng-init="init()">
      <div class="row justify-content-center h-100" ng-if="users">
          <div class="col-md-4 col-xl-3 chat">
              <div class="card mb-sm-3 mb-md-0 contacts_card">
                  <div class="card-body contacts_body">
                      <small ng-if="newMessage != null && newMessage != toUser">New message {{ newMessage }}</small>
                      <ui class="contacts">

                          <li class="active" ng-repeat="user in users" ng-click="selectUser(user)">
                              <div class="d-flex bd-highlight">
                                  <div class="user_info">
                                      <span>{{ user.firstname }}</span>
                                      <p>online</p>
                                  </div>
                              </div>
                          </li>
                      </ui>
                  </div>
                  <div class="card-footer"></div>
              </div>
          </div>
          <div class="col-md-8 col-xl-9 chat">

              <div class="card" ng-repeat="user in users" ng-if="toUser.id == user.id">
                  <div class="card-header msg_head">
                      <div class="d-flex bd-highlight">

                          <div class="user_info">
                              <span>{{ toUser.firstname }}</span>
                          </div>
                      </div>
                  </div>
                  <div class="card-body msg_card_body" id="chatBox"  scroll-glue>

                      <div ng-repeat="msg in messages" >
                          <div class="d-flex" ng-class="{'justify-content-end' : msg.to == toUser.id,'justify-content-start' : msg.from == toUser.id}">
                              <div class="msg_cotainer">
                                  {{ msg.message }}

                              </div>
                          </div>

                      </div>
                  </div>
                  <div class="card-footer">
                      <div class="input-group">
                          <div class="input-group-append">
                              <span class="input-group-text attach_btn"><i class="fas fa-paperclip"></i></span>
                          </div>
                          <textarea class="form-control type_msg" placeholder="Type your message..." ng-model="$ctrl.messageModel" ng-keyup="$event.keyCode == 13 && sendMsg();"></textarea>
                          <div class="input-group-append" ng-click="sendMsg();">
                              <span class="input-group-text send_btn"><i class="fas fa-location-arrow"></i>Send</span>
                          </div>
                      </div>
                  </div>
              </div>
          </div>
      </div>
  </div>
</span>
